var loc=window.location,mid=$('#main').attr('data-mid'),is_process=!1;function favorite(b,c,d){is_login?('undefined'==typeof d&&(d='add'),$('.btn-favorite-'+b).prop('disabled',!0),$('.bp-btn-like').prop('disabled',!0),$.ajax({url:'/ajax/favorite',method:'POST',data:{movie_id:b,action:d},dataType:'json',success:function(f){$('.btn-favorite-'+b).removeAttr('disabled'),$('.bp-btn-like').removeAttr('disabled'),1==f.status&&(1==c?($('#message-content').html(f.message),$('#pop-alert').modal('show'),'user'==window.location.pathname.split('/')[1]&&$('[data-movie-id='+b+']').addClass('ml-item-remove')):($('#favorite-alert').show(),$('#favorite-message').html(f.message),setTimeout(function(){$('#favorite-alert').hide()},5e3),$('#button-favorite').html(f.content),$('.popover-like').hide()))}})):$('#pop-login').modal('show')}function clearNotify(){var b=confirm('Are you sure delete all notify?');b&&$.ajax({url:'/ajax/user_clear_notify',method:'POST',dataType:'json',success:function(c){1===c.status&&window.location.reload()}})}function loadNotify(){0===$('#list-notify .notify-item').length&&$.ajax({url:base_url+'ajax/user_load_notify',type:'GET',dataType:'json',success:function(b){1===b.status&&($('#notify-loading').remove(),$('#list-notify').html(b.html),0<b.notify_unread?$('.feed-number').text(b.notify_unread):$('.feed-number').text(''))}})}function ajaxContentBox(b){$('div#'+b+' #content-box').is(':empty')&&$.ajax({url:'/ajax/home-suggest/'+b,type:'GET',dataType:'json',success:function(c){switch(c.type){case'top-view':$('#top-view #content-box').html(c.content);break;case'top-favorite':$('#top-favorite #content-box').html(c.content);break;case'top-rating':$('#top-rating #content-box').html(c.content);}}})}function validateEmail(b){var c=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;return 0<b.length&&c.test(b)}function isCookieEnabled(){var b=!!navigator.cookieEnabled;return'undefined'!=typeof navigator.cookieEnabled||b||(document.cookie='testcookie',b=-1!=document.cookie.indexOf('testcookie')),b}function searchMovie(){var b=$('input[name=keyword]').val();''!==b.trim()&&(b=b.replace(/(<([^>]+)>)/gi,'').replace(/[`~!@#$%^&*()_|\=?;:'",.<>\{\}\[\]\\\/]/gi,''),b=b.split(' ').join('+'),window.location.href='/search/'+b)}function searchMovieHome(){var b=$('input[name=keyword-home]').val();''!==b.trim()&&(b=b.replace(/(<([^>]+)>)/gi,'').replace(/[`~!@#$%^&*()_|\=?;:'",.<>\{\}\[\]\\\/]/gi,''),b=b.split(' ').join('+'),window.location.href='/search/'+b)}function trailer_watch(b){let c=$('#pop-trailer');c.on('show.bs.modal',function(){$('#iframe-trailer').attr('src',b)}),c.on('hide.bs.modal',function(){$('#iframe-trailer').attr('src','')})}var isMobile=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),base_url='//'+document.domain+'/',is_login=!1;$(document).ready(function(){(zy=$('body').attr('data-ts'),$('#search a.box-title').click(function(){$('#search .box').toggleClass('active')}),$('.mobile-menu').click(function(){$('#menu,.mobile-menu').toggleClass('active'),$('#search, .mobile-search').removeClass('active')}),$('.mobile-search').click(function(){$('#search,.mobile-search').toggleClass('active'),$('#menu, .mobile-menu').removeClass('active')}),$('.filter-toggle').click(function(){$('#filter').toggleClass('active'),$('.filter-toggle').toggleClass('active')}),$('.bp-btn-light').click(function(){$('.bp-btn-light, #overlay, #media-player, #content-embed, #comment-area').toggleClass('active')}),$('#overlay').click(function(){$('.bp-btn-light, #overlay, #media-player, #content-embed, #comment-area').removeClass('active')}),$('.bp-btn-auto').click(function(){$('.bp-btn-auto').toggleClass('active')}),$('#toggle, .cac-close').click(function(){$('#comment').toggleClass('active')}),$('.top-menu> li').bind('mouseover',function(){$(this).find('.sub-container').css('display','block')}),$('.top-menu> li').bind('mouseout',function(){$(this).find('.sub-container').css('display','none')}),0<$('#slider').length)&&(new Swiper('#slider',{preloadImages:!1,lazy:{loadPrevNext:!0},fadeEffect:{crossFade:!0},pagination:{el:'.swiper-pagination',type:'bullets',clickable:!0},autoplay:{delay:3e3,disableOnInteraction:!1}}),$(function(){$('.tn-news, .tn-notice').perfectScrollbar()})),Cookies.get('night-mode')?($('#switch-mode').addClass('active'),$('head').append('<link href=\'/css/main-dark.css\' type=\'text/css\' rel=\'stylesheet\' />')):$('#switch-mode').removeClass('active'),$('#switch-mode').click(function(){Cookies.get('night-mode')?Cookies.remove('night-mode',{path:'/'}):Cookies.set('night-mode',1,{expires:365,path:'/'}),location.reload()}),Cookies.get('night-mode')&&$('#switch-mode').addClass('active');var d=0;$(window).on('scroll',function(){$(window).scrollTop()<d?'fixed'!==$('header').css('position')&&($('header').css({position:'fixed',top:-$('header').outerHeight()}),$('header').animate({top:'0px'},500),$('#main').css('padding-top',$('header').outerHeight())):($('header').css({position:'relative',top:'0px'}),$('#main').css('padding-top','0')),d=$(window).scrollTop()}),$(function(){function k(){var l=$(this),m=l.find('.modal-dialog');l.css('display','block'),m.css('margin-top',Math.max(0,($(window).height()-m.height())/2))}$('.modal').on('show.bs.modal',k),$(window).on('resize',function(){$('.modal:visible').each(k)})});var f=!0;$('#search-suggest-menu').mouseover(function(){f=!1}),$('#search-suggest-menu').mouseout(function(){f=!0});var g=null;$('input[name=keyword]').keyup(function(){null!=g&&clearTimeout(g),g=setTimeout(function(){g=null;var k=$('input[name=keyword]').val().trim();3<k.length?$.ajax({url:'/search',type:'POST',dataType:'json',data:{keyword:k},success:function(l){$('#search-suggest-menu').html(l.html),''===l.html.trim()?$('#search-suggest-menu').hide():$('#search-suggest-menu').show()}}):$('#search-suggest-menu').hide()},100)}),$('input[name=keyword]').blur(function(){f&&$('#search-suggest-menu').hide()}),$('input[name=keyword]').focus(function(){''!==$('#search-suggest-menu').html()&&$('#search-suggest-menu').show()}),$('input[name=keyword]').keypress(function(k){13===k.which&&searchMovie()});var h=!0;$('#search-suggest-home').mouseover(function(){h=!1}),$('#search-suggest-home').mouseout(function(){h=!0}),$('input[name=keyword-home]').keyup(function(){null!=g&&clearTimeout(g),g=setTimeout(function(){g=null;var k=$('input[name=keyword-home]').val().trim();3<k.length?$.ajax({url:'/search',type:'POST',dataType:'json',data:{keyword:k},success:function(l){$('#search-suggest-home').html(l.content),''===l.content.trim()?$('#search-suggest-home').hide():$('#search-suggest-home').show()}}):$('#search-suggest-home').hide()},100)}),$('input[name=keyword-home]').blur(function(){h&&$('#search-suggest-home').hide()}),$('input[name=keyword-home]').focus(function(){''!==$('#search-suggest-home').html()&&$('#search-suggest-home').show()}),$('input[name=keyword-home]').keypress(function(k){13===k.which&&searchMovieHome()}),$('#login-form').submit(function(k){$('#login-submit').prop('disabled',!0),$('#login-loading').show();var l=$(this).serializeArray(),m=$(this).attr('action');$.ajax({url:m,type:'POST',data:l,dataType:'json',beforeSend:function(){$('#login-submit').addClass('hidden'),$('#login-loading').removeClass('hidden'),$('#login-error').addClass('hidden')},error:function(n){404===n.status?($('#login-error').removeClass('hidden').text(n.responseJSON.message),$('#login-submit').removeAttr('disabled').removeClass('hidden'),$('#login-loading').addClass('hidden'),location.reload()):($('#login-loading').remove(),$('#login-submit').remove(),$('#login-error').removeClass('hidden').text(n.responseJSON.message))},success:function(){location.reload()}}),k.preventDefault()}),$('#register-form').submit(function(k){$('#register-submit').prop('disabled',!0),$('#register-loading').show();var l=$(this).serializeArray(),m=$(this).attr('action');$.ajax({url:m,type:'POST',data:l,dataType:'json',beforeSend:function(){$('#register-submit').addClass('hidden'),$('#register-loading').removeClass('hidden'),$('#register-error').addClass('hidden')},error:function(n){404===n.status?($('#register-error').removeClass('hidden').text(n.responseJSON.message),$('#register-submit').removeAttr('disabled').removeClass('hidden'),$('#register-loading').addClass('hidden')):($('#register-loading').remove(),$('#register-submit').remove(),$('#register-error').removeClass('hidden').text(n.responseJSON.message))},success:function(){location.reload()}}),k.preventDefault()}),$('#forgot-form').submit(function(k){$('#forgot-submit').prop('disabled',!0),$('#forgot-loading').show();var l=$(this).serializeArray(),m=$(this).attr('action');$.ajax({url:m,type:'POST',data:l,dataType:'json',success:function(n){0===n.status&&($('#forgot-error-message').show(),$('#forgot-error-message').text(n.message)),1==n.status&&($('#forgot-success-message').show(),$('#forgot-success-message').text(n.message)),$('#forgot-submit').removeAttr('disabled'),$('#forgot-loading').hide()}}),k.preventDefault()}),$('#request-form').submit(function(k){$('#request-submit').prop('disabled',!0),$('#request-loading').show();var l=$(this).serializeArray();$.ajax({url:'/ajax/user_request',type:'POST',data:l,dataType:'json',success:function(m){if($('.error-block').hide(),0===m.status)for(var n in m.messages)$('#error-'+n).show(),$('#error-'+n).text(m.messages[n]);1===m.status&&($('#message-success').show(),setTimeout(function(){$('#message-success').hide()},5e3),document.getElementById('request-form').reset()),$('#request-submit').removeAttr('disabled'),$('#request-loading').hide(),grecaptcha.reset(recap_request)}}),k.preventDefault()});new LazyLoad({elements_selector:'.lazy'});$('[data-toggle="tooltip"]').tooltip({trigger:'hover'}),isMobile||$('.ml-mask').qtip({content:{text:function(k,l){$.ajax({url:l.elements.target.attr('data-url'),type:'GET',success:function(m){l.set('content.text',m)}})},title:function(){return $(this).attr('title')}},position:{my:'top left',at:'top right',viewport:$(window),effect:!1,target:'mouse',adjust:{mouse:!1},show:{effect:!1}},hide:{fixed:!0},style:{classes:'qtip-light qtip-bootstrap',width:320}})}),$('#filter-movies').click(function(){let b=[],c=[],d=[];$('.genre-ids:checked').each(function(){b.push($(this).val())}),$('.country-ids:checked').each(function(){c.push($(this).val())}),b=0<b.length?b.join(','):'all',c=0<c.length?c.join(','):'all';let f=$('input[name=year]:checked').val();'custom'===f&&(f=$('input[name=custom-year]').val());let g=$('input[name=type]:checked').val();d.push('genre='+b),d.push('country='+c),d.push('types='+g),d.push('year='+f),window.location.href='/filter?'+d.join('&')}),$(document).on('click','#favorite',function(){let b=$(this).attr('data-movie'),c=$(this).attr('data-act');$.ajax({url:'/ajax/favorite',type:'POST',dataType:'json',data:{mid:b,act:c},error:function(d){toastr.error(d.responseJSON.message)},success:function(d){is_process='added'===c,$('#mid-'+b).remove(),toastr.success(d.message)}})});